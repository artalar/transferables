(function(a,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(a=typeof globalThis<"u"?globalThis:a||self,d(a.Transferables={}))})(this,function(a){"use strict";const d=Object.getPrototypeOf(Int8Array),C=globalThis.AudioData,w=globalThis.VideoFrame,S=globalThis.OffscreenCanvas,E=globalThis.RTCDataChannel,T="ReadableStream"in globalThis,p="WritableStream"in globalThis,b="TransformStream"in globalThis,A="MessageChannel"in globalThis,O="MessagePort"in globalThis,M="ArrayBuffer"in globalThis,v="AudioData"in globalThis,D="ImageBitmap"in globalThis,R="VideoFrame"in globalThis,B="OffscreenCanvas"in globalThis,V="RTCDataChannel"in globalThis,F={ReadableStreamExists:T,WritableStreamExists:p,TransformStreamExists:b,MessageChannelExists:A,MessagePortExists:O,ArrayBufferExists:M,AudioDataExists:v,ImageBitmapExists:D,VideoFrameExists:R,OffscreenCanvasExists:B,RTCDataChannelExists:V};async function P(){const n=await(async()=>{try{if(!A)return!1;const l=new MessageChannel,s={port1:l.port1},r=structuredClone(s,{transfer:[l.port1]}),t=new MessageChannel,e={port1:r.port1};await new Promise(o=>{t.port1.postMessage(e,[e.port1]),t.port1.onmessage=()=>{o()},t.port2.onmessage=({data:i})=>{t.port2.postMessage(i,[i.port1])}}),t.port1.close()}catch(l){return console.warn(l),!1}return!0})(),c=await(async()=>{try{if(!T||!p||!b)return!1;const l={readonly:new ReadableStream,writeonly:new WritableStream,tranformonly:new TransformStream},s=structuredClone(l,{transfer:[l.readonly,l.writeonly,l.tranformonly]}),r=new MessageChannel,t=s;await new Promise(e=>{r.port1.postMessage(t,[t.readonly,t.writeonly,t.tranformonly]),r.port1.onmessage=()=>{e()},r.port2.onmessage=({data:o})=>{r.port2.postMessage(o,[o.readonly,o.writeonly,o.tranformonly].filter(i=>i!==void 0))}}),r.port1.close()}catch(l){return console.warn(l),!1}return!0})();return{channel:n,streams:c}}function h(n){return typeof n=="object"&&n!==null||typeof n=="function"}function g(n){return n instanceof d||n instanceof DataView}function f(n){return T&&n instanceof ReadableStream||p&&n instanceof WritableStream||b&&n instanceof TransformStream}function m(n){return A&&n instanceof MessageChannel}function y(n){return M&&n instanceof ArrayBuffer||O&&n instanceof MessagePort||v&&n instanceof C||D&&n instanceof ImageBitmap||R&&n instanceof w||B&&n instanceof S||V&&n instanceof E}function I(n){return Array.from(new Set(n))}function L(n,c=!1,l=1e4){const s=new Set([]);let r=[],t=[n];for(;t.length>0&&l>0;){for(let e of t)if(y(e))s.add(e);else if(g(e))s.add(e.buffer);else if(m(e))s.add(e.port1),s.add(e.port2);else if(c&&f(e))s.add(e);else if(!f(e)&&h(e)){const o=Array.isArray(e)?e:Object.values(e),i=o.length;for(let u=0;u<i;u++)r.push(o[u])}t=r,r=[],l--}return Array.from(s)}function*j(n,c=!1,l=1e4){const s=new Set([]);let r=[n],t=[];for(;r.length>0&&l>0;){for(let e of r)if(!s.has(e)){if(g(e)){s.add(e);const{buffer:o}=e;if(s.has(o))continue;yield o,s.add(o)}else if(y(e))yield e,s.add(e);else if(m(e)){if(s.add(e),s.has(e.port1)||s.has(e.port2))continue;yield e.port1,yield e.port2,s.add(e.port1),s.add(e.port2)}else if(c&&f(e))yield e,s.add(e);else if(!f(e)&&h(e)){const o=Array.isArray(e)?e:Object.values(e),i=o.length;for(let u=0;u<i;u++)t.push(o[u])}}r=t,t=[],l--}return s.clear(),r=null,t=null,null}function W(n,c=!1,l=1e4){let s=[n],r=[];for(;s.length>0&&l>0;){for(let t of s){if(g(t))return!0;if(y(t))return!0;if(m(t))return!0;if(c&&f(t))return!0;if(!f(t)&&h(t)){const e=Array.isArray(t)?t:Object.values(t),o=e.length;for(let i=0;i<o;i++)r.push(e[i])}}s=r,r=[],l--}return s=null,r=null,!1}a.AVAILABLE_TRANSFERABLE_OBJECTS=F,a.AudioData=C,a.OffscreenCanvas=S,a.RTCDataChannel=E,a.TypedArray=d,a.VideoFrame=w,a.filterOutDuplicates=I,a.getTransferable=j,a.getTransferables=L,a.hasTransferables=W,a.isMessageChannel=m,a.isObject=h,a.isStream=f,a.isSupported=P,a.isTransferable=y,a.isTypedArray=g,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
