(function(s,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(s=typeof globalThis<"u"?globalThis:s||self,d(s.Transferables={}))})(this,function(s){"use strict";const d=Object.getPrototypeOf(Int8Array),p=globalThis.AudioData,T=globalThis.VideoFrame,b=globalThis.OffscreenCanvas,w=globalThis.RTCDataChannel;async function C(){const n=await(async()=>{try{const l=new MessageChannel,a={port1:l.port1},r=structuredClone(a,{transfer:[l.port1]}),t=new MessageChannel,e={port1:r.port1};await new Promise(o=>{t.port1.postMessage(e,[e.port1]),t.port1.onmessage=()=>{o()},t.port2.onmessage=({data:i})=>{t.port2.postMessage(i,[i.port1])}}),t.port1.close()}catch(l){return console.warn(l),!1}return!0})(),u=await(async()=>{try{const l={readonly:new ReadableStream,writeonly:new WritableStream,tranformonly:new TransformStream},a=structuredClone(l,{transfer:[l.readonly,l.writeonly,l.tranformonly]}),r=new MessageChannel,t=a;await new Promise(e=>{r.port1.postMessage(t,[t.readonly,t.writeonly,t.tranformonly]),r.port1.onmessage=()=>{e()},r.port2.onmessage=({data:o})=>{r.port2.postMessage(o,[o.readonly,o.writeonly,o.tranformonly].filter(i=>i!=null))}}),r.port1.close()}catch(l){return console.warn(l),!1}return!0})();return{channel:n,streams:u}}function h(n){return typeof n=="object"&&n!==null||typeof n=="function"}function g(n){return n instanceof d||n instanceof DataView}function f(n){return"ReadableStream"in globalThis&&n instanceof ReadableStream||"WritableStream"in globalThis&&n instanceof WritableStream||"TransformStream"in globalThis&&n instanceof TransformStream}function y(n){return"MessageChannel"in globalThis&&n instanceof MessageChannel}function m(n){return"ArrayBuffer"in globalThis&&n instanceof ArrayBuffer||"MessagePort"in globalThis&&n instanceof MessagePort||"AudioData"in globalThis&&n instanceof p||"ImageBitmap"in globalThis&&n instanceof ImageBitmap||"VideoFrame"in globalThis&&n instanceof T||"OffscreenCanvas"in globalThis&&n instanceof b||"RTCDataChannel"in globalThis&&n instanceof w}function A(n){return Array.from(new Set(n))}function S(n,u=!1,l=1e4){const a=new Set([]);let r=[],t=[n];for(;t.length>0&&l>0;){for(let e of t)if(g(e))a.add(e.buffer);else if(m(e))a.add(e);else if(y(e))a.add(e.port1),a.add(e.port2);else if(u&&f(e))a.add(e);else if(!f(e)&&h(e)){const o=Array.isArray(e)?e:Object.values(e),i=o.length;for(let c=0;c<i;c++)r.push(o[c])}t=r,r=[],l--}return Array.from(a)}function*O(n,u=!1,l=1e4){const a=new Set([]);let r=[n],t=[];for(;r.length>0&&l>0;){for(let e of r)if(!a.has(e)){if(g(e)){a.add(e);const{buffer:o}=e;if(a.has(o))continue;yield o,a.add(o)}else if(m(e))yield e,a.add(e);else if(y(e)){if(a.add(e),a.has(e.port1)||a.has(e.port2))continue;yield e.port1,yield e.port2,a.add(e.port1),a.add(e.port2)}else if(u&&f(e))yield e,a.add(e);else if(!f(e)&&h(e)){const o=Array.isArray(e)?e:Object.values(e),i=o.length;for(let c=0;c<i;c++)t.push(o[c])}}r=t,t=[],l--}return a.clear(),r=null,t=null,null}function M(n,u=!1,l=1e4){let a=[n],r=[];for(;a.length>0&&l>0;){for(let t of a){if(g(t))return!0;if(m(t))return!0;if(y(t))return!0;if(u&&f(t))return!0;if(h(t)&&!f(t)){const e=Array.isArray(t)?t:Object.values(t),o=e.length;for(let i=0;i<o;i++)r.push(e[i])}}a=r,r=[],l--}return a=null,r=null,!1}s.AudioData=p,s.OffscreenCanvas=b,s.RTCDataChannel=w,s.TypedArray=d,s.VideoFrame=T,s.filterOutDuplicates=A,s.getTransferable=O,s.getTransferables=S,s.hasTransferables=M,s.isMessageChannel=y,s.isObject=h,s.isStream=f,s.isSupported=C,s.isTransferable=m,s.isTypedArray=g,Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
