(function(r,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(r=typeof globalThis<"u"?globalThis:r||self,d(r.Transferables={}))})(this,function(r){"use strict";const d=Object.getPrototypeOf(Int8Array),T=globalThis.AudioData,b=globalThis.VideoFrame,p=globalThis.OffscreenCanvas,w=globalThis.RTCDataChannel;function C(){const a=(()=>{try{const s=new MessageChannel,n={channel:new MessageChannel};structuredClone(n,{transfer:[n.channel.port1,n.channel.port2]});const t={channel:new MessageChannel};s.port1.postMessage(t,{transfer:[t.channel.port1,t.channel.port2]}),s.port1.close()}catch(s){return console.warn(s),!1}return!0})(),f=(()=>{try{const s=new MessageChannel,n={readonly:new ReadableStream,writeonly:new WritableStream,tranformonly:new TransformStream};structuredClone(n,{transfer:[n.readonly,n.writeonly,n.tranformonly]});const t={readonly:new ReadableStream,writeonly:new WritableStream,tranformonly:new TransformStream};s.port1.postMessage(t,{transfer:[t.readonly,t.writeonly,t.tranformonly]}),s.port1.close()}catch(s){return console.warn(s),!1}return!0})();return{channel:a,streams:f}}function h(a){return typeof a=="object"&&a!==null||typeof a=="function"}function g(a){return a instanceof d||a instanceof DataView}function o(a){return"ReadableStream"in globalThis&&a instanceof ReadableStream||"WritableStream"in globalThis&&a instanceof WritableStream||"TransformStream"in globalThis&&a instanceof TransformStream}function y(a){return"MessageChannel"in globalThis&&a instanceof MessageChannel}function m(a){return"ArrayBuffer"in globalThis&&a instanceof ArrayBuffer||"MessagePort"in globalThis&&a instanceof MessagePort||"AudioData"in globalThis&&a instanceof T||"ImageBitmap"in globalThis&&a instanceof ImageBitmap||"VideoFrame"in globalThis&&a instanceof b||"OffscreenCanvas"in globalThis&&a instanceof p||"RTCDataChannel"in globalThis&&a instanceof w}function S(a){return Array.from(new Set(a))}function A(a,f=!1,s=1e4){const n=new Set([]);let t=[],l=[a];for(;l.length>0&&s>0;){for(let e of l)if(g(e))n.add(e.buffer);else if(m(e))n.add(e);else if(y(e))n.add(e.port1),n.add(e.port2);else if(f&&o(e))n.add(e);else if(!o(e)&&h(e)){const i=Array.isArray(e)?e:Object.values(e),u=i.length;for(let c=0;c<u;c++)t.push(i[c])}l=t,t=[],s--}return Array.from(n)}function*M(a,f=!1,s=1e4){const n=new Set([]);let t=[a],l=[];for(;t.length>0&&s>0;){for(let e of t)if(!n.has(e)){if(g(e)){n.add(e);const{buffer:i}=e;if(n.has(i))continue;yield i,n.add(i)}else if(m(e))yield e,n.add(e);else if(y(e)){if(n.add(e),n.has(e.port1)||n.has(e.port2))continue;yield e.port1,yield e.port2,n.add(e.port1),n.add(e.port2)}else if(f&&o(e))yield e,n.add(e);else if(!o(e)&&h(e)){const i=Array.isArray(e)?e:Object.values(e),u=i.length;for(let c=0;c<u;c++)l.push(i[c])}}t=l,l=[],s--}return n.clear(),t=null,l=null,null}function O(a,f=!1,s=1e4){let n=[a],t=[];for(;n.length>0&&s>0;){for(let l of n){if(g(l))return!0;if(m(l))return!0;if(y(l))return!0;if(f&&o(l))return!0;if(h(l)&&!o(l)){const e=Array.isArray(l)?l:Object.values(l),i=e.length;for(let u=0;u<i;u++)t.push(e[u])}}n=t,t=[],s--}return n=null,t=null,!1}r.AudioData=T,r.OffscreenCanvas=p,r.RTCDataChannel=w,r.TypedArray=d,r.VideoFrame=b,r.filterOutDuplicates=S,r.getTransferable=M,r.getTransferables=A,r.hasTransferables=O,r.isMessageChannel=y,r.isObject=h,r.isStream=o,r.isSupported=C,r.isTransferable=m,r.isTypedArray=g,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
