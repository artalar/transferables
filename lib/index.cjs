"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const p=Object.getPrototypeOf(Int8Array),y=globalThis.AudioData,m=globalThis.VideoFrame,T=globalThis.OffscreenCanvas,b=globalThis.RTCDataChannel;async function w(){const n=await(async()=>{try{const s=new MessageChannel,a={port1:s.port1},r=structuredClone(a,{transfer:[s.port1]}),t=new MessageChannel,e={port1:r.port1};await new Promise(l=>{t.port1.postMessage(e,[e.port1]),t.port1.onmessage=()=>{l()},t.port2.onmessage=({data:o})=>{t.port2.postMessage(o,[o.port1])}}),t.port1.close()}catch(s){return console.warn(s),!1}return!0})(),i=await(async()=>{try{const s={readonly:new ReadableStream,writeonly:new WritableStream,tranformonly:new TransformStream},a=structuredClone(s,{transfer:[s.readonly,s.writeonly,s.tranformonly]}),r=new MessageChannel,t=a;await new Promise(e=>{r.port1.postMessage(t,[t.readonly,t.writeonly,t.tranformonly]),r.port1.onmessage=()=>{e()},r.port2.onmessage=({data:l})=>{r.port2.postMessage(l,[l.readonly,l.writeonly,l.tranformonly].filter(o=>o!=null))}}),r.port1.close()}catch(s){return console.warn(s),!1}return!0})();return{channel:n,streams:i}}function u(n){return typeof n=="object"&&n!==null||typeof n=="function"}function d(n){return n instanceof p||n instanceof DataView}function c(n){return"ReadableStream"in globalThis&&n instanceof ReadableStream||"WritableStream"in globalThis&&n instanceof WritableStream||"TransformStream"in globalThis&&n instanceof TransformStream}function g(n){return"MessageChannel"in globalThis&&n instanceof MessageChannel}function h(n){return"ArrayBuffer"in globalThis&&n instanceof ArrayBuffer||"MessagePort"in globalThis&&n instanceof MessagePort||"AudioData"in globalThis&&n instanceof y||"ImageBitmap"in globalThis&&n instanceof ImageBitmap||"VideoFrame"in globalThis&&n instanceof m||"OffscreenCanvas"in globalThis&&n instanceof T||"RTCDataChannel"in globalThis&&n instanceof b}function C(n){return Array.from(new Set(n))}function A(n,i=!1,s=1e4){const a=new Set([]);let r=[],t=[n];for(;t.length>0&&s>0;){for(let e of t)if(d(e))a.add(e.buffer);else if(h(e))a.add(e);else if(g(e))a.add(e.port1),a.add(e.port2);else if(i&&c(e))a.add(e);else if(!c(e)&&u(e)){const l=Array.isArray(e)?e:Object.values(e),o=l.length;for(let f=0;f<o;f++)r.push(l[f])}t=r,r=[],s--}return Array.from(a)}function*S(n,i=!1,s=1e4){const a=new Set([]);let r=[n],t=[];for(;r.length>0&&s>0;){for(let e of r)if(!a.has(e)){if(d(e)){a.add(e);const{buffer:l}=e;if(a.has(l))continue;yield l,a.add(l)}else if(h(e))yield e,a.add(e);else if(g(e)){if(a.add(e),a.has(e.port1)||a.has(e.port2))continue;yield e.port1,yield e.port2,a.add(e.port1),a.add(e.port2)}else if(i&&c(e))yield e,a.add(e);else if(!c(e)&&u(e)){const l=Array.isArray(e)?e:Object.values(e),o=l.length;for(let f=0;f<o;f++)t.push(l[f])}}r=t,t=[],s--}return a.clear(),r=null,t=null,null}function O(n,i=!1,s=1e4){let a=[n],r=[];for(;a.length>0&&s>0;){for(let t of a){if(d(t))return!0;if(h(t))return!0;if(g(t))return!0;if(i&&c(t))return!0;if(u(t)&&!c(t)){const e=Array.isArray(t)?t:Object.values(t),l=e.length;for(let o=0;o<l;o++)r.push(e[o])}}a=r,r=[],s--}return a=null,r=null,!1}exports.AudioData=y;exports.OffscreenCanvas=T;exports.RTCDataChannel=b;exports.TypedArray=p;exports.VideoFrame=m;exports.filterOutDuplicates=C;exports.getTransferable=S;exports.getTransferables=A;exports.hasTransferables=O;exports.isMessageChannel=g;exports.isObject=u;exports.isStream=c;exports.isSupported=w;exports.isTransferable=h;exports.isTypedArray=d;
