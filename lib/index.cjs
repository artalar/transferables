"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const A=Object.getPrototypeOf(Int8Array),C=globalThis.AudioData,S=globalThis.VideoFrame,w=globalThis.OffscreenCanvas,E=globalThis.RTCDataChannel,p="ReadableStream"in globalThis,y="WritableStream"in globalThis,T="TransformStream"in globalThis,b="MessageChannel"in globalThis,O="MessagePort"in globalThis,M="ArrayBuffer"in globalThis,v="AudioData"in globalThis,D="ImageBitmap"in globalThis,R="VideoFrame"in globalThis,B="OffscreenCanvas"in globalThis,x="RTCDataChannel"in globalThis,P={ReadableStreamExists:p,WritableStreamExists:y,TransformStreamExists:T,MessageChannelExists:b,MessagePortExists:O,ArrayBufferExists:M,AudioDataExists:v,ImageBitmapExists:D,VideoFrameExists:R,OffscreenCanvasExists:B,RTCDataChannelExists:x};async function V(){async function n(){try{if(!b)return!1;const s=new MessageChannel,r={port1:s.port1},e=structuredClone(r,{transfer:[s.port1]}),a=new MessageChannel,o={port1:e.port1};await new Promise(l=>{a.port1.postMessage(o,[o.port1]),a.port1.onmessage=()=>{l()},a.port2.onmessage=({data:u})=>{a.port2.postMessage(u,[u.port1])}}),a.port1.close()}catch(s){return console.warn(s),!1}return!0}async function f(){try{if(!p||!y||!T)return!1;const s={readonly:new ReadableStream,writeonly:new WritableStream,tranformonly:new TransformStream},r=structuredClone(s,{transfer:[s.readonly,s.writeonly,s.tranformonly]}),e=new MessageChannel,a=r;await new Promise(o=>{e.port1.postMessage(a,[a.readonly,a.writeonly,a.tranformonly]),e.port1.onmessage=()=>{o()},e.port2.onmessage=({data:l})=>{e.port2.postMessage(l,[l.readonly,l.writeonly,l.tranformonly].filter(u=>u!==void 0))}}),e.port1.close()}catch(s){return console.warn(s),!1}return!0}const[i,t]=await Promise.all([n(),f()]);return{channel:i,streams:t}}function d(n){return typeof n=="object"&&n!==null||typeof n=="function"}function g(n){return n instanceof A||n instanceof DataView}function c(n){return p&&n instanceof ReadableStream||y&&n instanceof WritableStream||T&&n instanceof TransformStream}function h(n){return b&&n instanceof MessageChannel}function m(n){return M&&n instanceof ArrayBuffer||O&&n instanceof MessagePort||v&&n instanceof C||D&&n instanceof ImageBitmap||R&&n instanceof S||B&&n instanceof w||x&&n instanceof E}function F(n){return Array.from(new Set(n))}function I(n,f=!1,i=1e4){const t=new Set([]),s=[[n]];for(const r of s){for(let e of r)if(m(e))t.add(e);else if(g(e))t.add(e.buffer);else if(h(e))t.add(e.port1),t.add(e.port2);else if(f&&c(e))t.add(e);else if(!c(e)&&d(e)){const a=Array.isArray(e)?e:Object.values(e);a.length&&s.push(a)}if(--i===0)break}return Array.from(t)}function*L(n,f=!1,i=1e4){const t=new Set([]);let s=[n],r=[];for(;s.length>0&&i>0;){for(let e of s)if(!t.has(e)){if(g(e)){t.add(e);const{buffer:a}=e;if(t.has(a))continue;yield a,t.add(a)}else if(m(e))yield e,t.add(e);else if(h(e)){if(t.add(e),t.has(e.port1)||t.has(e.port2))continue;yield e.port1,yield e.port2,t.add(e.port1),t.add(e.port2)}else if(f&&c(e))yield e,t.add(e);else if(!c(e)&&d(e)){const a=Array.isArray(e)?e:Object.values(e),o=a.length;for(let l=0;l<o;l++)r.push(a[l])}}s=r,r=[],i--}return t.clear(),s=null,r=null,null}function q(n,f=!1,i=1e4){let t=[n],s=[];for(;t.length>0&&i>0;){for(let r of t){if(g(r))return!0;if(m(r))return!0;if(h(r))return!0;if(f&&c(r))return!0;if(!c(r)&&d(r)){const e=Array.isArray(r)?r:Object.values(r),a=e.length;for(let o=0;o<a;o++)s.push(e[o])}}t=s,s=[],i--}return t=null,s=null,!1}exports.AVAILABLE_TRANSFERABLE_OBJECTS=P;exports.AudioData=C;exports.OffscreenCanvas=w;exports.RTCDataChannel=E;exports.TypedArray=A;exports.VideoFrame=S;exports.filterOutDuplicates=F;exports.getTransferable=L;exports.getTransferables=I;exports.hasTransferables=q;exports.isMessageChannel=h;exports.isObject=d;exports.isStream=c;exports.isSupported=V;exports.isTransferable=m;exports.isTypedArray=g;
